(()=>{const e=document,t=e.body,r=document.documentElement,n="/content/projects.json",a=t.dataset.lang||r.lang||"en",o=r.dataset.page||"";o.startsWith("project:");let s=null,c=null;const i=e=>String(e??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),l=e=>String(e??"").replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function d(e){return String(e??"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}function u(e,t){const r=`${t}_en`;return e[`${t}_${a}`]??e[r]??""}function p(e){return Array.isArray(e)?e:"string"==typeof e&&e.length?[e]:[]}function f(e){if(!e)return"";const t=e.split("·").map(e=>e.trim());return"fr"===a&&t[1]?t[1]:t[0]||e}function h(e){return e?e.startsWith("/")?e:`/${e}`:""}function g(e){const t=u(e,"title"),r=u(e,"summary"),n=p(u(e,"highlights")),o=u(e,"cover_alt"),s=e.period||"",c=f(e.role),g=function(e){const t=encodeURIComponent(e);return"fr"===a?`/fr/projets/${t}.html`:`/projects/${t}.html`}(e.id),m=h(e.cover),v=(e.stack||[]).map(d).filter(Boolean).join(","),y=(e.tags||[]).map(d).filter(Boolean).join(","),$=function(e){const t=String(e||"").match(/\d{4}/g);return t&&t.length?t[t.length-1]:"n-a"}(s),j=n.map(e=>`<li>${i(e)}</li>`).join(""),E=(e.stack||[]).map(e=>`<span class="badge">${i(e)}</span>`).join("");return`<article class="project-card tilt-card" data-reveal data-stack="${v}" data-tags="${y}" data-year="${$}">\n    <a class="project-card__link" href="${g}">\n      <div class="project-card__media">\n        <picture>\n          <img src="${m}" alt="${l(o)}" width="1600" height="900" loading="lazy" decoding="async">\n        </picture>\n      </div>\n      <div class="project-card__body">\n        <div class="project-card__header">\n          <h3>${i(t)}</h3>\n          <p class="project-card__summary">${i(r)}</p>\n        </div>\n        <ul class="project-card__highlights">${j}</ul>\n        <div class="project-card__meta">\n          <span class="project-card__period">${i(s)}</span>\n          <span class="project-card__role">${i(c)}</span>\n        </div>\n        <div class="project-card__tags">${E}</div>\n      </div>\n    </a>\n  </article>`}function m(e,t){const r=e.sort((e,t)=>e.label.localeCompare(t.label)).map(e=>`<option value="${e.value}">${i(e.label)}</option>`).join("");return`<option value="all" selected>${i(t)}</option>${r}`}function v(e){const t=e.querySelector("[data-project-list]");if(!t)return;const r=Array.from(t.querySelectorAll(".project-card")),n=e.querySelector('select[data-filter="stack"]'),a=e.querySelector('select[data-filter="tag"]'),o=e.querySelector('select[data-filter="year"]'),s=e.querySelector("[data-status]");if(!s)return;const c=r.length;function i(e,t){return e?e.replace(/\{count\}/g,String(t)).replace(/\{total\}/g,String(c)):""}function l(){const e=n?n.value:"all",t=a?a.value:"all",l=o?o.value:"all";let d=0;r.forEach(r=>{const n=(r.dataset.stack||"").split(",").filter(Boolean),a=(r.dataset.tags||"").split(",").filter(Boolean),o=r.dataset.year||"",s="all"===e||n.includes(e),c="all"===t||a.includes(t),i=s&&c&&("all"===l||o===l);r.style.display=i?"":"none",i&&(d+=1)}),function(e){s&&(s.textContent=0===e?i(s.dataset.statusEmpty,e)||"No projects to display.":i(e===c?s.dataset.statusAll:s.dataset.statusFiltered,e))}(d)}n&&n.addEventListener("change",l),a&&a.addEventListener("change",l),o&&o.addEventListener("change",l),s.dataset.statusAll&&(s.textContent=i(s.dataset.statusAll,c)),l()}function y(t){const r=e.querySelector("[data-projects-root]");if(!r)return;const n=r.querySelector("[data-project-list]");if(!n)return;if(!("static"===r.dataset.renderSource)){const e=t.map(e=>g(e)).join("");n.innerHTML=e}!function(e,t){const r=e.querySelector("[data-project-count]");if(!r)return;const n=r.dataset.countLabel||r.querySelector("span")?.textContent||"",a=r.querySelector("strong");a&&(a.textContent=String(t));const o=r.querySelector("span");o&&n&&(o.textContent=n),n&&r.setAttribute("aria-label",`${t} ${n}`.trim())}(r,n.querySelectorAll(".project-card").length),function(e,t){const r=t.querySelector('select[data-filter="stack"]'),n=t.querySelector('select[data-filter="tag"]'),a=t.querySelector('select[data-filter="year"]');if(r){const t=new Map;e.forEach(e=>{(e.stack||[]).forEach(e=>{const r=d(e);r&&!t.has(r)&&t.set(r,e)})});const n=r.dataset.defaultLabel||r.querySelector("option")?.textContent||"All",a=Array.from(t.entries()).map(([e,t])=>({value:e,label:t}));r.innerHTML=m(a,n)}if(n){const t=new Map;e.forEach(e=>{(e.tags||[]).forEach(e=>{const r=d(e);r&&!t.has(r)&&t.set(r,e)})});const r=n.dataset.defaultLabel||n.querySelector("option")?.textContent||"All",a=Array.from(t.entries()).map(([e,t])=>({value:e,label:t}));n.innerHTML=m(a,r)}if(a){const t=new Set;e.forEach(e=>{const r=(e.period||"").match(/\d{4}/g);r&&r.forEach(e=>t.add(e))});const r=a.dataset.defaultLabel||a.querySelector("option")?.textContent||"All",n=Array.from(t).sort((e,t)=>Number(t)-Number(e)).map(e=>({value:e,label:e}));a.innerHTML=m(n,r)}}(t,r),v(r),e.dispatchEvent(new CustomEvent("projects:hydrated"))}function $(e=[]){return e.map(e=>`<li>${i(e)}</li>`).join("")}function j(t){const r=e.querySelector("[data-project-detail]");if(!r)return;if("static"===r.dataset.renderSource)return void e.dispatchEvent(new CustomEvent("projects:hydrated"));const n=r.dataset.projectId||o.replace("project:","");if(!n)return;const s=t.find(e=>e.id===n),c=r.querySelector("[data-project-hero]"),d=r.querySelector("[data-project-highlights]"),g=r.querySelector("[data-project-metrics]"),m=r.querySelector("[data-project-gallery]"),v=r.dataset.loadingMessage||"Loading project…";if(!s)return void(c&&(c.innerHTML=`<div class="project-hero__copy"><p>${i(r.dataset.errorMessage||"Project not found.")}</p></div>`));const y=u(s,"title"),j=u(s,"summary"),E=p(u(s,"highlights")),S=p(u(s,"metrics")),b=u(s,"cover_alt"),L=h(s.cover),q=s.gallery||[],_=f(s.role),w={overview:r.dataset.labelOverview||"Overview",period:r.dataset.labelPeriod||"Period",role:r.dataset.labelRole||"Role",client:r.dataset.labelClient||"Client",stack:r.dataset.labelStack||"Focus",highlights:r.dataset.labelHighlights||"Highlights",metrics:r.dataset.labelMetrics||"Metrics"},A={contact:r.dataset.ctaContact||"Contact",projects:r.dataset.ctaProjects||"All projects",projectsHref:r.dataset.projectsHref||("fr"===a?"/fr/projets/index.html":"/projects/index.html"),contactEmail:r.dataset.contactEmail||"hello@mohamedalimabrouki.com"};if(c&&(c.innerHTML=`<div class="project-hero__copy">\n        <p class="eyebrow">${i(w.overview)}</p>\n        <h1>${i(y)}</h1>\n        <p>${i(j)}</p>\n        <div class="project-hero__meta">\n          <dl>\n            <div><dt>${i(w.period)}</dt><dd>${i(s.period||"")}</dd></div>\n            <div><dt>${i(w.role)}</dt><dd>${i(_)}</dd></div>\n            <div><dt>${i(w.client)}</dt><dd>${i(s.client_or_brand||"")}</dd></div>\n            <div><dt>${i(w.stack)}</dt><dd>${function(e=[]){return e.map(e=>`<span class="badge">${i(e)}</span>`).join("")}(s.stack||[])}</dd></div>\n          </dl>\n          <div class="project-hero__actions">\n            <a class="btn btn--primary" href="mailto:${l(A.contactEmail)}">${i(A.contact)}</a>\n            <a class="btn btn--ghost" href="${l(A.projectsHref)}">${i(A.projects)}</a>\n          </div>\n        </div>\n      </div>\n      <div class="project-hero__media">\n        <picture>\n          <img src="${L}" alt="${l(b)}" width="1600" height="900" loading="eager" decoding="async" fetchpriority="high">\n        </picture>\n      </div>`),d){const e=E.length?`<ul>${$(E)}</ul>`:`<p>${i(v)}</p>`;d.innerHTML=`<h2>${i(w.highlights)}</h2>${e}`}if(g){const e=S.length?`<ul>${$(S)}</ul>`:`<p>${i(v)}</p>`;g.innerHTML=`<h2>${i(w.metrics)}</h2>${e}`}if(m){const e=q.map(e=>`<figure class="gallery__item">\n            <picture>\n              <img src="${h(e)}" alt="${l(b)}" width="1600" height="900" loading="lazy" decoding="async">\n            </picture>\n          </figure>`).join("");m.innerHTML=e}e.dispatchEvent(new CustomEvent("projects:hydrated"))}function E(){const t=e.querySelector("[data-projects-root]"),r=e.querySelector("[data-project-detail]"),a=Boolean(t),o=r&&"static"!==r.dataset.renderSource;a||o?(s?Promise.resolve(s):(c||(c=fetch(n,{credentials:"same-origin"}).then(e=>{if(!e.ok)throw new Error(`Failed to load ${n}`);return e.json()}).then(e=>(s=Array.isArray(e)?e:[],s)).catch(e=>{throw c=null,e})),c)).then(e=>{a&&y(e),o&&j(e)}).catch(t=>{!function(t){const r=e.querySelector("[data-projects-root]"),n=r?.querySelector("[data-status]");n&&(n.textContent=n.dataset.statusError||"Unable to load projects.");const a=e.querySelector("[data-project-detail]");if(a){const e=a.dataset.errorMessage||"Unable to load this project.",t=a.querySelector("[data-project-hero]");t&&(t.innerHTML=`<div class="project-hero__copy"><p>${i(e)}</p></div>`)}console.error(t)}(t)}):r&&"static"===r.dataset.renderSource&&e.dispatchEvent(new CustomEvent("projects:hydrated"))}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",E):E()})(),document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".fade-in-up-v2");if(!e)return;const t=e.querySelectorAll("li"),r=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(t.forEach((e,t)=>{e.style.transitionDelay=150*t+"ms",e.classList.add("is-visible")}),r.unobserve(e.target))})},{threshold:.1});r.observe(e)}),(()=>{const e=document,t=document.body,r=e.querySelector(".site-header"),n=e.querySelector("[data-site-nav]"),a=e.querySelector("[data-nav-toggle]"),o=Array.from(e.querySelectorAll(".site-nav__link")),s=Array.from(e.querySelectorAll("[data-section]")),c=e.querySelector("[data-current-year]");let i=Array.from(e.querySelectorAll("[data-reveal]"));const l=e.getElementById("contact-form"),d=window.matchMedia("(prefers-reduced-motion: reduce)"),u=window.matchMedia("(pointer: fine)"),p="IntersectionObserver"in window;let f=null,h=null,g=null,m=d.matches;function v(e){m=e,t.dataset.reducedMotion=e?"true":"false"}function y(e,t){"function"==typeof e.addEventListener?e.addEventListener("change",t):"function"==typeof e.addListener&&e.addListener(t)}v(m),y(d,e=>{v(e.matches),S()}),y(u,()=>{S()}),c&&(c.textContent=String((new Date).getFullYear())),a&&n&&(a.addEventListener("click",()=>{const e="true"===a.getAttribute("aria-expanded");a.setAttribute("aria-expanded",String(!e)),n.classList.toggle("is-open",!e)}),o.forEach(e=>{e.addEventListener("click",()=>{a.setAttribute("aria-expanded","false"),n.classList.remove("is-open")})}));const $={rootMargin:"-50% 0px -40% 0px",threshold:0};if(p){const e=new IntersectionObserver(e=>{e.forEach(e=>{if(!e.isIntersecting)return;const t=e.target.getAttribute("id");o.forEach(e=>{const r=e.dataset.navTarget;e.dataset.active=r===t?"true":"false"})})},$);s.forEach(t=>e.observe(t))}function j(){if(!r)return;const e=window.scrollY>24;r.classList.toggle("is-scrolled",e)}function E(){if("function"==typeof f&&(f(),f=null),m||!u.matches)return;const t=e.querySelector("[data-parallax-root]");if(!t)return;const r=Array.from(t.querySelectorAll("[data-parallax-layer]"));if(!r.length)return;let n=!1;function a(e){n||(n=!0,window.requestAnimationFrame(()=>{const a=t.getBoundingClientRect();!function(e,t){r.forEach(r=>{const n=Number(r.dataset.parallaxLayer)||.15,a=(e-.5)*n*40,o=(t-.5)*n*40;r.style.transform=`translate3d(${a.toFixed(2)}px, ${o.toFixed(2)}px, 0)`})}((e.clientX-a.left)/a.width,(e.clientY-a.top)/a.height),n=!1}))}function o(){r.forEach(e=>{e.style.transform="translate3d(0,0,0)"})}t.addEventListener("pointermove",a),t.addEventListener("mouseleave",o),f=()=>{t.removeEventListener("pointermove",a),t.removeEventListener("mouseleave",o),o()}}function S(){E(),function(){if("function"==typeof h&&(h(),h=null),m||!u.matches)return;const t=Array.from(e.querySelectorAll(".tilt-card"));if(!t.length)return;const r=[];t.forEach(e=>{const t=()=>{e.style.transition="transform 0.35s ease"},n=t=>{const r=e.getBoundingClientRect(),n=(t.clientX-r.left)/r.width-.5,a=(-6*((t.clientY-r.top)/r.height-.5)).toFixed(2),o=(6*n).toFixed(2);e.style.transform=`rotateX(${a}deg) rotateY(${o}deg)`},a=()=>{e.style.transform="rotateX(0deg) rotateY(0deg)"};e.addEventListener("pointerenter",t),e.addEventListener("pointermove",n),e.addEventListener("pointerleave",a),r.push(()=>{e.removeEventListener("pointerenter",t),e.removeEventListener("pointermove",n),e.removeEventListener("pointerleave",a),e.style.transform="none",e.style.transition=""})}),h=()=>{r.forEach(e=>e()),h=null}}(),i=Array.from(e.querySelectorAll("[data-reveal]")),i.length&&(p?(g&&(g.disconnect(),g=null),m?i.forEach(e=>e.classList.add("is-visible")):(g=new IntersectionObserver((e,t)=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("is-visible"),t.unobserve(e.target))})},{threshold:.2}),i.forEach(e=>{e.classList.contains("is-visible")||g.observe(e)}))):i.forEach(e=>e.classList.add("is-visible")))}function b(){S(),l&&l.addEventListener("submit",e=>{e.preventDefault();const t=new FormData(l),r=t.get("name")||"",n=t.get("email")||"",a=t.get("message")||"",o=l.dataset.mailto||"mailto:hello@mohamedalimabrouki.com?subject=Project%20enquiry",s=o.includes("?")?"&":"?",c=`${o}${s}body=${encodeURIComponent(`${r?`Name: ${r}\n`:""}${n?`Email: ${n}\n\n`:""}${a}`)}`;window.location.href=c}),function(){const t=e.querySelector(".site-nav__list");if(!t)return;const r=t.querySelector(".magic-line");if(!r)return;function n(e){if(!e)return r.style.transform="translateX(0)",void(r.style.width="0px");const n=e.getBoundingClientRect(),a=t.getBoundingClientRect(),o=n.left-a.left,s=n.width;r.style.transform=`translateX(${o}px)`,r.style.width=`${s}px`}o.forEach(e=>{e.addEventListener("mouseenter",()=>n(e))}),t.addEventListener("mouseleave",()=>{n(t.querySelector('.site-nav__link[data-active="true"]'))});const a=new IntersectionObserver(e=>{e.forEach(e=>{if(!e.isIntersecting)return;const t=e.target.getAttribute("id");o.forEach(e=>{const r=e.dataset.navTarget===t;e.dataset.active=r?"true":"false",r&&n(e)})})},$);s.forEach(e=>a.observe(e))}()}j(),window.addEventListener("scroll",j,{passive:!0}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",b):b(),document.addEventListener("projects:hydrated",()=>{S()})})();